(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{23:function(t,a,e){var i=e(27);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e(6).default)("5307f70f",i,!0,{})},24:function(t,a,e){var i=e(29);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e(6).default)("fd51eef6",i,!0,{})},25:function(t,a,e){var i=e(31);"string"==typeof i&&(i=[[t.i,i,""]]),i.locals&&(t.exports=i.locals);(0,e(6).default)("52c05a48",i,!0,{})},26:function(t,a,e){"use strict";var i=e(23);e.n(i).a},27:function(t,a,e){(t.exports=e(5)(!1)).push([t.i,".table .tab-content[data-v-eecb56f4],.table[data-v-eecb56f4]{display:flex;flex-wrap:wrap}.table .tab-handle[data-v-eecb56f4]{display:flex}.table .tab[data-v-eecb56f4]{cursor:pointer;width:100px;text-align:center;border:1px solid #ccc;margin:5px;position:relative}.table .tab.active[data-v-eecb56f4]{background:#eee}.table .tab .tips[data-v-eecb56f4]{position:absolute;width:18px;height:18px;background:#ff0;right:-5px;top:-10px;border-radius:50%;font-size:12px}.table .table-content[data-v-eecb56f4]{position:relative;width:100%}.table .header[data-v-eecb56f4]{border:1px solid #ccc;margin-top:10px;display:flex;width:90%;margin-left:5%}.table .header .header-tab[data-v-eecb56f4]{flex:1;text-align:center;border-right:1px solid #ccc;height:30px;line-height:30px;font-weight:700}.table .header .header-tab[data-v-eecb56f4]:last-child{border:0 none}.table .header .detail[data-v-eecb56f4]{flex:2;max-width:40%;min-width:40%;box-sizing:border-box}.table .inner[data-v-eecb56f4]{width:90%;margin-left:5%;margin-top:5px;border:1px solid #ccc}.table .inner .row[data-v-eecb56f4]{border-bottom:1px solid #ccc;width:100%;display:flex;cursor:pointer}.table .inner .row[data-v-eecb56f4]:last-child{border:0 none}.table .inner .row.error[data-v-eecb56f4]{background:rgba(255,0,0,.1)}.table .inner .row.matched[data-v-eecb56f4]{background:rgba(0,255,0,.1);cursor:not-allowed}.table .inner .row.current[data-v-eecb56f4]{background:rgba(0,0,0,.1);cursor:pointer}.table .inner .row>div[data-v-eecb56f4]{flex:1;border-right:1px solid #ccc;padding:5px 0;text-align:center}.table .inner .row>div[data-v-eecb56f4]:last-child{border:0 none}.table .inner .row .detail[data-v-eecb56f4]{flex:2;text-align:left!important;padding-left:5px;max-width:40%;min-width:40%;box-sizing:border-box}",""])},28:function(t,a,e){"use strict";var i=e(24);e.n(i).a},29:function(t,a,e){(t.exports=e(5)(!1)).push([t.i,"[data-v-0a14722c]{margin:0;padding:0}[data-v-0a14722c]::-webkit-scrollbar-track{-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.2);border-radius:10px;width:10px}[data-v-0a14722c]::-webkit-scrollbar{width:5px;height:5px}[data-v-0a14722c]::-webkit-scrollbar-thumb{border-radius:2px;background:#bbb;-webkit-box-shadow:inset 0 0 6px rgba(0,0,0,.4)}.wrapper[data-v-0a14722c]{padding:10px;box-sizing:border-box;height:100%;min-height:100vh;max-height:100vh;position:relative;overflow:auto;border-left:1px solid #ccc;border-right:1px solid #ccc}.table-content .table-name[data-v-0a14722c]{cursor:pointer}.table-content .table-name.active[data-v-0a14722c],.table-content .table-name[data-v-0a14722c]:hover{color:rgba(0,0,255,.5)}",""])},30:function(t,a,e){"use strict";var i=e(25);e.n(i).a},31:function(t,a,e){(t.exports=e(5)(!1)).push([t.i,".index[data-v-c8b81692]{width:100%;min-height:100%;position:relative}.index .content[data-v-c8b81692]{width:100%;height:100vh;overflow:hidden;display:flex;justify-content:space-between;position:relative}.index .content>div[data-v-c8b81692]{flex:1;max-width:45%;min-width:45%}.index .content .match[data-v-c8b81692]{position:fixed;top:30%;left:45%;max-width:10%;min-width:10%;text-align:center;height:100%;padding:0 5px}",""])},32:function(t,a,e){"use strict";e.r(a);var i={data:function(){return{currentData:[],currentTab:"",sumExpand:0,sumIncome:0,start:0,hideTabs:!1,originData:[],first:!0,currentRow:{}}},props:{data:{type:Array,required:!0},id:{type:Number,default:0}},methods:{showAll:function(){this.currentTab="all";var t=[];this.data.forEach(function(a){t=t.concat(a.data)}),this.currentData=t,this.sumExpand=this.currentData.map(function(t){return t.expand}).reduce(function(t,a){return t+a}),this.sumIncome=this.currentData.map(function(t){return t.income}).reduce(function(t,a){return t+a}),this.originData=this.currentData,this.first&&(this.$emit("setAllData",this.originData),this.first=!1)},unMatched:function(){this.currentTab="unMatched",this.currentData=this.originData.filter(function(t){return!t.matchId})},changeTab:function(t){this.currentTab=t.name,this.currentData=t.data,this.sumExpand=t.data.map(function(t){return t.expand}).reduce(function(t,a){return t+a}),this.sumIncome=t.data.map(function(t){return t.income}).reduce(function(t,a){return t+a})},getTips:function(t){return t.filter(function(t){return!t.matchId}).length},clickRow:function(t){t.matchId||(this.currentRow=t,this.$emit("setMathData",this.currentRow))}},mounted:function(){this.showAll()}},n=(e(26),e(7)),s=Object(n.a)(i,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"table"},[e("div",{staticClass:"tab-handle"},[e("div",{staticClass:"tab",on:{click:function(){t.hideTabs=!t.hideTabs}}},[t._v(t._s(this.hideTabs?"展开日期筛选":"收起日期筛选"))]),t._v(" "),e("div",{staticClass:"tab",class:{active:"all"===t.currentTab},on:{click:t.showAll}},[t._v("\n        全部\n        "),e("span",{staticClass:"tips"},[t._v(t._s(t.getTips(this.originData)))])]),t._v(" "),e("div",{staticClass:"tab",class:{active:"unMatched"===t.currentTab},on:{click:t.unMatched}},[t._v("\n        未匹配\n        "),e("span",{staticClass:"tips"},[t._v(t._s(t.getTips(this.originData)))])])]),t._v(" "),t.hideTabs?t._e():e("div",{staticClass:"tab-content"},t._l(t.data,function(a,i){return e("div",{key:i,staticClass:"tab",class:{active:a.name===t.currentTab},on:{click:function(){return t.changeTab(a)}}},[t._v("\n          "+t._s(a.name)+"\n        "),e("span",{staticClass:"tips"},[t._v(t._s(t.getTips(a.data)))])])}),0),t._v(" "),e("div",{staticClass:"table-content"},[e("p",[t._v("当"+t._s("all"===this.currentTab?"月":"日")+"总收入："+t._s(this.sumExpand))]),t._v(" "),e("p",[t._v("当"+t._s("all"===this.currentTab?"月":"日")+"总支出："+t._s(this.sumIncome))]),t._v(" "),t._m(0),t._v(" "),e("div",{staticClass:"inner",attrs:{id:"table-inner"+t.id}},[e("div",{staticClass:"table-wrapper"},t._l(t.currentData,function(a,i){return e("div",{key:i,staticClass:"row",class:{error:a.error,matched:a.matchId,current:a.id===t.currentRow.id},on:{click:function(){return t.clickRow(a)}}},[e("div",{staticClass:"row-tab detail"},[t._v(t._s(a.detail))]),t._v(" "),e("div",{staticClass:"row-tab"},[t._v(t._s(a.income))]),t._v(" "),e("div",{staticClass:"row-tab"},[t._v(t._s(a.expand))]),t._v(" "),e("div",{staticClass:"row-tab"},[t._v(t._s(a.number))])])}),0)])])])},[function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"header"},[e("div",{staticClass:"header-tab detail"},[t._v("摘要")]),t._v(" "),e("div",{staticClass:"header-tab"},[t._v("收入")]),t._v(" "),e("div",{staticClass:"header-tab"},[t._v("支出")]),t._v(" "),e("div",{staticClass:"header-tab"},[t._v("单据号")])])}],!1,null,"eecb56f4",null).exports,l=e(22).default,r={name:"read-xlsx",components:{Table:s},props:{id:{type:Number,default:0}},data:function(){return{monthData:[],dateCol:0,detailCol:0,expandCol:0,incomeCol:0,numberCol:0,start:0,end:0,tableName:"",filePath:null,tableShow:!1,tableDetailShow:!1,originData:[],currentTable:{data:{},index:0}}},methods:{open:function(t){this.$electron.shell.openExternal(t)},setAllData:function(t){this.$emit("setAllData",t)},setMathData:function(t){this.$emit("setMathData",t)},chooseTable:function(t,a){this.currentTable.data=t,this.currentTable.index=a},tableConfirm:function(){var t=this;this.tableShow=!1,this.$nextTick(function(){t.tableDetailShow=!0})},cancelTable:function(){this.tableShow=!1},cancelDetail:function(){this.dateCol=0,this.detailCol=0,this.expandCol=0,this.incomeCol=0,this.tableCol=0,this.numberCol=0,this.start=0,this.end=0},fileChange:function(){var t=this;this.$emit("toggleSpin"),this.filePath=this.$refs.file.files[0].path,setTimeout(function(){t.originData=l.parse(t.filePath),t.$emit("toggleSpin"),t.tableShow=!0},500)},build:function(){var t=this,a=this.originData[this.currentTable.index];this.tableName=a.name;var e=0;a.data.slice(this.start-1,this.end).forEach(function(a){var i=new Date(t.fixTime(a[t.dateCol-1])).toLocaleDateString();if("Invalid Date"!==i){var n=t.monthData.find(function(t){return t.name===i}),s={expand:a[t.expandCol-1]?+a[t.expandCol-1]:0,income:a[t.incomeCol-1]?+a[t.incomeCol-1]:0,detail:a[t.detailCol-1],number:a[t.numberCol-1],id:e,matchId:null};e++,n?n.data.push(s):t.monthData.push({name:i,data:[s]})}}),console.log(this.currentData)},fixTime:function(t){return 24*t*3600*1e3+new Date("1989-12-30").getTime()}}},o=(e(28),Object(n.a)(r,function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"wrapper"},[e("div",{staticClass:"inner"},[e("input",{ref:"file",attrs:{type:"file"},on:{change:t.fileChange}}),t._v(" "),e("h2",{staticClass:"table-name"},[t._v(t._s(t.tableName))]),t._v(" "),e("Modal",{attrs:{title:"填详情"},on:{"on-ok":t.build,"on-cancel":t.cancelDetail},model:{value:t.tableDetailShow,callback:function(a){t.tableDetailShow=a},expression:"tableDetailShow"}},[e("div",{staticClass:"form"},[t._v("\n        日期列数："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.dateCol,callback:function(a){t.dateCol=a},expression:"dateCol"}}),t._v("\n        摘要列数："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.detailCol,callback:function(a){t.detailCol=a},expression:"detailCol"}}),t._v(" "),e("br"),t._v("\n        支出列数："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.expandCol,callback:function(a){t.expandCol=a},expression:"expandCol"}}),t._v("\n        收入列数："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.incomeCol,callback:function(a){t.incomeCol=a},expression:"incomeCol"}}),t._v(" "),e("br"),t._v("\n        单据号列数："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.numberCol,callback:function(a){t.numberCol=a},expression:"numberCol"}}),t._v(" "),e("br"),t._v("\n        数据行范围（始）："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.start,callback:function(a){t.start=a},expression:"start"}}),t._v(" "),e("br"),t._v("\n        数据行范围（终）："),e("InputNumber",{attrs:{min:1,size:"small"},model:{value:t.end,callback:function(a){t.end=a},expression:"end"}})],1)]),t._v(" "),e("Modal",{attrs:{title:"选择表"},on:{"on-ok":t.tableConfirm,"on-cancel":t.cancelTable},model:{value:t.tableShow,callback:function(a){t.tableShow=a},expression:"tableShow"}},[e("div",{staticClass:"table-content"},t._l(t.originData,function(a,i){return e("div",{staticClass:"table-name",class:{active:t.currentTable.data.name===a.name},on:{click:function(){return t.chooseTable(a,i)}}},[t._v(t._s(a.name))])}),0)]),t._v(" "),t.monthData.length?e("Table",{attrs:{id:t.id,data:t.monthData},on:{setMathData:t.setMathData,setAllData:t.setAllData}}):t._e()],1)])},[],!1,null,"0a14722c",null).exports),c=(e(30),Object(n.a)({components:{ReadXlsx:o},data:function(){return{firstTime:!1,spinShow:!1,leftData:null,rightData:null,leftMatchData:null,rightMatchData:null,matchId:1,BrowserWindow:null}},methods:{lcs:function(t,a){var e=Math.max;t=t?(t+"").trim():"",a=a?(a+"").trim():"";for(var i=t.length,n=a.length,s=[Array(n+1).fill(0)],l=1;l<=i;l++){s[l]=[0];for(var r=1;r<=n;r++)s[l][r]=t[l-1]===a[r-1]?s[l-1][r-1]+1:e(s[l-1][r],s[l][r-1])}return s[i][n]/e(t.length,a.length)},refresh:function(){location.reload()},autoMatch:function(){var t=this;this.spinShow=!0,setTimeout(function(){t.matchData(0,t.leftData,t.rightData),t.spinShow=!1,t.firstTime=!0},0)},matchData:function(t,a,e){var i=this;0===t&&a.forEach(function(t){var a=e.find(function(a){return.8<=i.lcs(t.detail||"",a.detail||"")&&!a.matchId&&(t.income===a.income&&0!==t.income&&0!==a.income||t.expand===a.expand&&0!==t.expand&&0!==a.expand)});a&&(t.matchId=a.matchId=i.matchId,i.matchId++)})},setLeftData:function(t){this.$set(this,"leftData",t),console.log(this.leftData)},setRightData:function(t){this.$set(this,"rightData",t),console.log(this.rightData)},setLeftMathData:function(t){this.$set(this,"leftMatchData",t),console.log(this.leftMatchData)},setRightMathData:function(t){this.$set(this,"rightMatchData",t),console.log(this.rightMatchData)},toggleSpin:function(){this.spinShow=!this.spinShow}}},function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"index"},[t.spinShow?e("Spin",{attrs:{size:"large",fix:""}}):t._e(),t._v(" "),e("div",{staticClass:"content"},[e("ReadXlsx",{attrs:{id:1},on:{setMathData:t.setLeftMathData,setAllData:t.setLeftData,toggleSpin:t.toggleSpin}}),t._v(" "),e("div",{staticClass:"match"},[e("Button",{staticStyle:{marginBottom:"20px"},attrs:{size:"small",disabled:t.firstTime||!t.leftData||!t.rightData},on:{click:t.autoMatch}},[t._v("自动匹配")]),t._v(" "),e("Button",{staticStyle:{marginBottom:"20px"},attrs:{disabled:!t.leftData||!t.rightData,size:"small"}},[t._v("手动匹配")]),t._v(" "),e("Button",{staticStyle:{marginBottom:"20px"},attrs:{disabled:!t.leftData||!t.rightData,size:"small"}},[t._v("提示")]),t._v(" "),e("Button",{attrs:{size:"small"},on:{click:t.refresh}},[t._v("重置")])],1),t._v(" "),e("ReadXlsx",{attrs:{id:2},on:{setMathData:t.setRightMathData,setAllData:t.setRightData,toggleSpin:t.toggleSpin}})],1)],1)},[],!1,null,"c8b81692",null));a.default=c.exports}}]);